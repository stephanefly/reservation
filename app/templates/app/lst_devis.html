{% extends 'app/base.html' %}
{% block content %}

<style>
body {
    background-image: None;
}

</style>
<h3>Liste des devis</h3>
<br>
<table id="table" class="table table-bordered table-striped" style="background-color:white">
    <thead>
        <th style="display: none">ID</th>
        <th>NOM</th>
        <th>DATE-EVENT</th>
        <th>PRIX</th>
        <th>STATUS</th>
    </thead>
    <tbody>
    {% for event in all_event %}
        <tr onclick="location.href='{% url 'info_event' event.id %}';" style="cursor:pointer;">
            <td style="display: none" >{{event.id}}</td>
            <td>{{event.client.nom}}</td>
            <td>{{event.event_details.date_evenement|date:"D d/m/Y" }}</td>
            <td>{{event.prix_proposed}}</td>
            <td class="status-cell" data-status="{{ event.status }}" >{{event.status}}</td>
        </tr>
    {% endfor %}
    </tbody>
</table>


<script type="text/javascript">
document.querySelectorAll('.status-cell').forEach(function(cell) {
    var status = cell.getAttribute('data-status');
    var color = ''; // Couleur par défaut
    switch (status) {
        case 'Calculed':
            color = 'rgba(255,136,0,0.65)'; // Jaune à 50% de transparence
            break;
        case 'Acompte OK':
            color = 'rgba(0, 128, 0, 0.65)'; // Vert à 50% de transparence
            break;
        case 'Initied':
            color = 'rgba(255, 105, 180, 0.65)'; // Rose (pink) à 50% de transparence
            break;
        case 'Sended':
            color = 'rgba(0,102,255,0.6)'; // Orange à 50% de transparence
            break;
    }
    cell.style.backgroundColor = color;
});

$(document).ready(function () {
    $('#table').DataTable({
        responsive: true, // Active la fonctionnalité responsive
        order: [[0, 'desc']],
        lengthChange: false,
        paging: false,
        searching: true,
        info: false,
        columns: [
            { data: 'id' },
            { data: 'nom' },
            { data: 'date' },
            { data: 'prix' },
            { data: 'status' },
        ]
    });
});

</script>

{% endblock %}